<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('../../components/head'); %>
        <title>Studors - Admin</title>
</head>

<style>
    #apiKey {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    #apiKey p {
        font-size: 12pt;
        color: #e8413c;
    }
    #apiKey p#key {
        visibility: hidden;
    }

    button {
        width: 90px;
    }

    #settings-box #apiKey #toggleButton {
        left: 0%;
        transform: none;
        margin-left: 12px;
        margin-right: 12px;
    }
</style>

<body>
    <%- include('../../components/header'); %>
    <div id="flex-box">
        <div id="holder">
            <div id="settings-box" style="width: fit-content;">
                <div id="apiKey">
                    <p style="margin-right: 12px">
                        API KEY: 
                    </p>
                    <p id="key"> <%= user.api_key %>
                    </p>
                    <button class="button" id="toggleButton" onclick="showMask()">Show</button>
                    <form method="post" action="apiReset">
                        <button class="button" onclick="if(confirm('Are you sure?\nResetting will require you to replace any API keys in any applications that you use. For example google sheets.')){}else{return false;};" type="submit">Reset</button>
                    </form>
                </div>
                <br><hr style="width: 100%">
                <form action="" method="post">
                    <label for="phone">Phone:</label>
                    <input type="tel" id="phone" name="phone"
                        pattern="^([2-9][0-8][0-9])[-]([2-9][0-9]{2})[-]([0-9]{4})$" value="<%=user.phone %>"
                        placeholder="800-555-0101"
                        oninvalid="setCustomValidity('Please enter a phone number with this style: ###-###-####')"
                        oninput="setCustomValidity('')">
                    <br>
                    <br>
                    <label for="dark_theme">Dark Mode:</label>
                    <label class="check"><input style="display: none;" type="checkbox" id="dark_theme" name="dark_theme" <%=user.dark_theme ? "checked" : "" %>>
                        <span></span>
                    </label>
                    <br>
                    <p id="small-error">
                        <%=error %>
                    </p>
                    <button type="submit">Save</button>
                </form>
            </div>
        </div>
    </div>
    <%- include('../../components/footer'); %>

<script>
function showMask() {
    var node = document.getElementById('key')
    var button = document.getElementById('toggleButton')
    var visibility = node.style.visibility;
    if (visibility == "visible") {
        button.textContent = "Show"
    } else {
        button.textContent = "Hide"
    }
    
    node.style.visibility = visibility == "visible" ? 'hidden' : "visible"
}
</script>
</body>

</html>